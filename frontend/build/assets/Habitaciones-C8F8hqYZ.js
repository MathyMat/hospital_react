import{a as s,j as e}from"./index-C2VTEInz.js";import{a as n}from"./index-xsH4HHeE.js";const N=()=>{const[b,_]=s.useState([]),[d,g]=s.useState([]),[h,x]=s.useState([]),[j,u]=s.useState([]),[i,m]=s.useState({paciente_id:"",habitacion_disponible_id:"",fecha_ingreso:"",fecha_salida_estimada:"",doctor_id:"",estado_paciente:"Estable",motivo_ingreso:""}),o=async()=>{try{const a=await n.get("http://localhost:3001/api/habitaciones/asignadas");_(a.data)}catch{alert("Error al cargar asignaciones")}},v=async()=>{try{const a=await n.get("http://localhost:3001/api/pacientes");g(a.data)}catch{alert("Error al cargar pacientes")}},f=async()=>{try{const a=await n.get("http://localhost:3001/api/doctores");x(a.data)}catch{alert("Error al cargar doctores")}},c=async()=>{try{const a=await n.get("http://localhost:3001/api/habitaciones/disponibles");u(a.data)}catch{alert("Error al cargar habitaciones disponibles")}},t=a=>{m({...i,[a.target.name]:a.target.value})},E=async()=>{console.log("Formulario enviado:",i);try{const a={paciente_id:i.paciente_id,habitacion_disponible_id:i.habitacion_disponible_id,fecha_ingreso:i.fecha_ingreso,fecha_salida_estimada:i.fecha_salida_estimada,medico_responsable:i.doctor_id,estado_paciente:i.estado_paciente,motivo_ingreso:i.motivo_ingreso};await n.post("http://localhost:3001/api/habitaciones/asignar",a),alert("Habitación asignada correctamente"),m({paciente_id:"",habitacion_disponible_id:"",fecha_ingreso:"",fecha_salida_estimada:"",doctor_id:"",estado_paciente:"Estable",motivo_ingreso:""}),await o(),await c()}catch(a){console.error("Error al asignar habitación:",a),alert("Error al asignar habitación")}},y=async a=>{try{await n.delete(`http://localhost:3001/api/habitaciones/asignadas/${a}`),await o(),await c()}catch{alert("Error al eliminar asignación")}};return s.useEffect(()=>{o(),v(),f(),c()},[]),e.jsxs("div",{className:"container mt-4",children:[e.jsx("h2",{children:"Registro de Habitaciones para Pacientes"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("select",{className:"form-control mb-2",name:"paciente_id",value:i.paciente_id,onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un paciente"}),d.map(a=>e.jsxs("option",{value:a.id,children:[a.nombre," ",a.apellido]},a.id))]}),e.jsxs("select",{className:"form-control mb-2",name:"habitacion_disponible_id",value:i.habitacion_disponible_id,onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione una habitación"}),j.map(a=>e.jsxs("option",{value:a.id,children:[a.numero," - ",a.tipo]},a.id))]}),e.jsx("input",{className:"form-control mb-2",type:"datetime-local",name:"fecha_ingreso",value:i.fecha_ingreso,onChange:t}),e.jsx("input",{className:"form-control mb-2",type:"datetime-local",name:"fecha_salida_estimada",value:i.fecha_salida_estimada,onChange:t}),e.jsxs("select",{className:"form-control mb-2",name:"doctor_id",value:i.doctor_id,onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un médico"}),h.map(a=>e.jsxs("option",{value:a.id,children:[a.nombre," ",a.apellido]},a.id))]}),e.jsxs("select",{className:"form-control mb-2",name:"estado_paciente",value:i.estado_paciente,onChange:t,children:[e.jsx("option",{value:"Estable",children:"Estable"}),e.jsx("option",{value:"Observación",children:"Observación"}),e.jsx("option",{value:"Crítico",children:"Crítico"})]}),e.jsx("input",{className:"form-control mb-2",type:"text",name:"motivo_ingreso",value:i.motivo_ingreso,onChange:t,placeholder:"Motivo de Ingreso"}),e.jsx("button",{className:"btn btn-primary",onClick:E,children:"Asignar Habitación"})]}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Paciente"}),e.jsx("th",{children:"Habitación"}),e.jsx("th",{children:"Ingreso"}),e.jsx("th",{children:"Salida Estimada"}),e.jsx("th",{children:"Médico"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Motivo"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:b.map(a=>{var r,p;return e.jsxs("tr",{children:[e.jsx("td",{children:a.id}),e.jsx("td",{children:((r=d.find(l=>l.id===a.paciente_id))==null?void 0:r.nombre)||"-"}),e.jsxs("td",{children:[a.numero_disponible," - ",a.tipo_disponible]}),e.jsx("td",{children:new Date(a.fecha_ingreso).toLocaleString()}),e.jsx("td",{children:new Date(a.fecha_salida_estimada).toLocaleString()}),e.jsx("td",{children:((p=h.find(l=>l.id===a.doctor_id))==null?void 0:p.nombre)||"-"}),e.jsx("td",{children:a.estado_paciente}),e.jsx("td",{children:a.motivo_ingreso}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>y(a.id),children:"Eliminar"})})]},a.id)})})]})]})};export{N as default};
